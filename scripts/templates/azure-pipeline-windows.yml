parameters:
    jobName: ''
    packageListsFile: ''
    triplet: ''
jobs:
- job: ${{ parameters.jobName }}
  pool:
    vmImage: 'vs2017-win2016'
  steps:
  - powershell: |
      ./bootstrap-vcpkg.bat
      $env:VCPKG_DEFAULT_TRIPLET = "${{ parameters.triplet }}"
      ./vcpkg install $(cat $env:packageListsFile)
      ./vcpkg export --output=$env:VCPKG_DEFAULT_TRIPLET --zip $(cat $env:packageListsFile)
    displayName: 'make'
    environment:
        VCPKG_DEFAULT_TRIPLET: ${{ parameters.triplet }}
        packageListsFile: ${{ parameters.packageListsFile }}
  - task: PublishBuildArtifacts@1
    inputs:
      pathtoPublish: '${{ parameters.triplet }}.zip'

